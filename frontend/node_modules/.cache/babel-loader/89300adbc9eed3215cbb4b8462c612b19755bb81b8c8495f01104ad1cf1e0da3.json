{"ast":null,"code":"import React,{useEffect,useState}from'react';import MapView from'./components/MapView';import ARViewer from'./components/ARViewer';import SiteCard from'./components/SiteCard';import UploadForm from'./components/UploadForm';import{listSites,login,register}from'./api';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function App(){var _find;const[sites,setSites]=useState([]);const[active,setActive]=useState(null);const[token,setToken]=useState(null);const[creds,setCreds]=useState({email:'demo@example.com',password:'demo1234'});async function ensureAuth(){try{const t=await login(creds.email,creds.password);setToken(t.access_token);}catch(e){const t=await register({email:creds.email,password:creds.password,full_name:'Demo'});setToken(t.access_token);}}async function refreshSites(){const data=await listSites();setSites(data);if(!active&&data.length)setActive(data[0]);}useEffect(()=>{ensureAuth().then(refreshSites);},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"header\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{style:{margin:0},children:\"\\u0623\\u0635\\u0648\\u0627\\u062A \\u0645\\u0631\\u0645\\u0651\\u0645\\u0629 \\u2014 \\u0633\\u0631\\u062F \\u0627\\u0644\\u0630\\u0627\\u0643\\u0631\\u0629 \\u0639\\u0628\\u0631 \\u0627\\u0644\\u0648\\u0627\\u0642\\u0639 \\u0627\\u0644\\u0645\\u0639\\u0632\\u0632\"}),/*#__PURE__*/_jsx(\"p\",{style:{opacity:.9,marginTop:6},children:\"\\u0645\\u0646\\u0635\\u0629 \\u062A\\u0641\\u0627\\u0639\\u0644\\u064A\\u0629 \\u0644\\u0625\\u062D\\u064A\\u0627\\u0621 \\u0627\\u0644\\u0645\\u0648\\u0627\\u0642\\u0639 \\u0627\\u0644\\u0645\\u0645\\u062D\\u064A\\u0629 \\u0639\\u0628\\u0631 \\u0642\\u0635\\u0635 \\u0648\\u0645\\u0648\\u0627\\u062F \\u0623\\u0631\\u0634\\u064A\\u0641\\u064A\\u0629 \\u0648AR\"})]})}),/*#__PURE__*/_jsxs(\"main\",{className:\"container\",style:{display:'grid',gap:16,gridTemplateColumns:'1.2fr 1fr'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid\",children:[/*#__PURE__*/_jsx(MapView,{sites:sites,onSelect:setActive}),active&&/*#__PURE__*/_jsx(ARViewer,{modelUrl:((_find=(active.media||[]).find(m=>m.type==='model3d'))===null||_find===void 0?void 0:_find.file_path)||''}),token&&/*#__PURE__*/_jsx(UploadForm,{token:token,onCreated:refreshSites})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:0},children:\"\\u0627\\u0644\\u0645\\u0648\\u0627\\u0642\\u0639\"}),/*#__PURE__*/_jsx(\"div\",{className:\"grid\",children:sites.map(s=>/*#__PURE__*/_jsx(SiteCard,{site:s,onOpen:setActive},s.id))})]})})]})]});}","map":{"version":3,"names":["React","useEffect","useState","MapView","ARViewer","SiteCard","UploadForm","listSites","login","register","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","_find","sites","setSites","active","setActive","token","setToken","creds","setCreds","email","password","ensureAuth","t","access_token","e","full_name","refreshSites","data","length","then","children","className","style","margin","opacity","marginTop","display","gap","gridTemplateColumns","onSelect","modelUrl","media","find","m","type","file_path","onCreated","map","s","site","onOpen","id"],"sources":["C:/Users/Admin/Desktop/free-lancer/jornal/frontend/src/App.jsx"],"sourcesContent":["\nimport React, { useEffect, useState } from 'react'\nimport MapView from './components/MapView'\nimport ARViewer from './components/ARViewer'\nimport SiteCard from './components/SiteCard'\nimport UploadForm from './components/UploadForm'\nimport { listSites, login, register } from './api'\n\nexport default function App() {\n  const [sites, setSites] = useState([])\n  const [active, setActive] = useState(null)\n  const [token, setToken] = useState(null)\n  const [creds, setCreds] = useState({ email:'demo@example.com', password:'demo1234' })\n\n  async function ensureAuth() {\n    try {\n      const t = await login(creds.email, creds.password)\n      setToken(t.access_token)\n    } catch(e) {\n      const t = await register({ email:creds.email, password:creds.password, full_name:'Demo' })\n      setToken(t.access_token)\n    }\n  }\n\n  async function refreshSites() {\n    const data = await listSites()\n    setSites(data)\n    if (!active && data.length) setActive(data[0])\n  }\n\n  useEffect(() => { ensureAuth().then(refreshSites) }, [])\n\n  return (\n    <>\n      <header>\n        <div className=\"container\">\n          <h1 style={{margin:0}}>أصوات مرمّمة — سرد الذاكرة عبر الواقع المعزز</h1>\n          <p style={{opacity:.9, marginTop:6}}>منصة تفاعلية لإحياء المواقع الممحية عبر قصص ومواد أرشيفية وAR</p>\n        </div>\n      </header>\n\n      <main className=\"container\" style={{display:'grid', gap:16, gridTemplateColumns:'1.2fr 1fr'}}>\n        <div className=\"grid\">\n          <MapView sites={sites} onSelect={setActive} />\n          {active && <ARViewer modelUrl={(active.media||[]).find(m => m.type==='model3d')?.file_path || ''} />}\n          {token && <UploadForm token={token} onCreated={refreshSites} />}\n        </div>\n        <div className=\"grid\">\n          <div className=\"card\">\n            <h2 style={{marginTop:0}}>المواقع</h2>\n            <div className=\"grid\">\n              {sites.map(s => <SiteCard key={s.id} site={s} onOpen={setActive} />)}\n            </div>\n          </div>\n        </div>\n      </main>\n    </>\n  )\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}